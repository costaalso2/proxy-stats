<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estado Real del Proxy</title>
    <style>
        body { font-family: sans-serif; background: #0a0a0a; color: white; text-align: center; padding: 20px; }
        .card { background: #161616; padding: 25px; border-radius: 20px; display: inline-block; width: 90%; max-width: 350px; border: 1px solid #333; }
        .progress-bg { background: #333; border-radius: 15px; height: 30px; margin: 15px 0; overflow: hidden; }
        #bar { background: linear-gradient(90deg, #00c853, #b2ff59); height: 100%; width: 0%; transition: width 1s ease; }
        .btn-group { display: flex; gap: 10px; justify-content: center; margin-top: 15px; }
        button { cursor: pointer; background: #222; color: white; border: 1px solid #444; padding: 8px 12px; border-radius: 10px; font-size: 12px; }
    </style>
</head>
<body>
    <div class="card">
        <h2 id="percent-text">Iniciando...</h2>
        <div class="progress-bg"><div id="bar"></div></div>
        <div id="usage-text" style="font-weight: bold;">0 MB / 1024 MB</div>
        
        <div style="text-align: left; font-size: 13px; margin-top: 15px; color: #aaa;">
            <div>‚è±Ô∏è <span id="label-upd">Actualizaci√≥n</span>: Cada 60s</div>
            <div>üì¶ <span id="label-req">Solicitudes</span>: <span id="req-val">Conectando...</span></div>
        </div>

        <div class="btn-group">
            <button id="lang-btn" onclick="toggleLang()">üåê Idioma: Espa√±ol</button>
            <button onclick="updateData()">üîÑ Actualizar Ahora</button>
        </div>
    </div>

    <script>
        const token = "2x3wt52c4rtbdbav7u4of5v4jgep9dfp1dj98zap";
        let isEn = (navigator.language || navigator.userLanguage).startsWith('en');

        const t = {
            es: { used: "Usado", upd: "Actualizaci√≥n", req: "Solicitudes", lang: "Espa√±ol" },
            en: { used: "Used", upd: "Update", req: "Requests", lang: "English" }
        };

        function toggleLang() {
            isEn = !isEn;
            updateData();
        }

        async function updateData() {
            const p = isEn ? t.en : t.es;
            document.getElementById('lang-btn').innerText = "üåê Idioma: " + p.lang;
            document.getElementById('label-upd').innerText = p.upd;
            document.getElementById('label-req').innerText = p.req;

            const url = "https://corsproxy.io/?" + encodeURIComponent("https://proxy.webshare.io/api/v2/proxy/stats/bandwidth/");

            try {
                const res = await fetch(url, { headers: { 'Authorization': `Token ${token}` } });
                const data = await res.json();
                const usedMB = (data.actual_usage / 1048576).toFixed(2);
                const percent = ((usedMB / 1024) * 100).toFixed(1);

                document.getElementById('bar').style.width = percent + "%";
                document.getElementById('percent-text').innerText = `${percent}% ${p.used}`;
                document.getElementById('usage-text').innerText = `${usedMB} MB / 1024 MB`;
                document.getElementById('req-val').innerText = "Activo";
            } catch (e) {
                document.getElementById('percent-text').innerText = "Error";
            }
        }

        // Se ejecuta al entrar autom√°ticamente
        updateData();
        // Se repite cada minuto
        setInterval(updateData, 60000);
    </script>
</body>
</html>

